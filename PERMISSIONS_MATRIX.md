# ๐ ูุตูููุฉ ุงูุตูุงุญูุงุช ุงููุงููุฉ

## ๐ ูุธุฑุฉ ุนุงูุฉ ุนูู ุงูุตูุงุญูุงุช

| ุงูููุฒุฉ | ๐ค User (0) | ๐ฐ Accountant (1) | ๐ Admin (2) |
|--------|-------------|-------------------|--------------|
| **ุชุณุฌูู ุงูุฏุฎูู/ุงูุชุณุฌูู** | โ | โ | โ |
| **ุนุฑุถ ุงูููู ุงูุดุฎุตู** | โ (ุฎุงุต ุจู) | โ (ุฎุงุต ุจู) | โ (ุฎุงุต ุจู) |
| **ุชุญุฏูุซ ุงูููู ุงูุดุฎุตู** | โ (ุฎุงุต ุจู) | โ (ุฎุงุต ุจู) | โ (ุฎุงุต ุจู) |
| **ูุฒุงููุฉ ุงูุงุดุชุฑุงู** | โ (ุฎุงุต ุจู) | โ (ุฎุงุต ุจู) | โ (ุฎุงุต ุจู) |
| **ุฅูุดุงุก ุทูุจุงุช ุฏูุน** | โ | โ | โ |
| **ุนุฑุถ ุทูุจุงุช ุงูุฏูุน** | โ (ุฎุงุต ุจู ููุท) | โ (ุฌููุน ุงูุทูุจุงุช) | โ (ุฌููุน ุงูุทูุจุงุช) |
| **ูุจูู/ุฑูุถ ุทูุจุงุช ุงูุฏูุน** | โ | โ | โ |
| **ุนุฑุถ ุงูุจุซ ุงููุจุงุดุฑ** | โ (ุฅุฐุง ูุงู live_access) | โ (ุฅุฐุง ูุงู live_access) | โ |
| **ุฅุฏุงุฑุฉ ุงูุจุซ ุงููุจุงุดุฑ** | โ | โ | โ |
| **ุนุฑุถ ุงูุณูุงูุฏุงุช** | โ | โ | โ |
| **ุฅุฏุงุฑุฉ ุงูุณูุงูุฏุงุช** | โ | โ | โ |
| **ุนุฑุถ ุงูุฅุดุนุงุฑุงุช** | โ (ุฎุงุต ุจู) | โ (ุฎุงุต ุจู) | โ (ุฎุงุต ุจู) |
| **ุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช** | โ | โ | โ |

---

## ๐ ุดุฑุญ ุชูุตููู ููุตูุงุญูุงุช

### ๐ค ุงููุณุชุฎุฏู ุงูุนุงุฏู (User - Role: 0)

#### โ ูุง ููููู ูุนูู:

1. **ุฅุฏุงุฑุฉ ุญุณุงุจู ุงูุดุฎุตู**
   - ุนุฑุถ ูุชุญุฏูุซ ูููู ุงูุดุฎุตู
   - ูุฒุงููุฉ ุจูุงูุงุช ุงูุงุดุชุฑุงู
   - ูุฑุงุกุฉ ุจูุงูุงุช ุงูุงุดุชุฑุงู ูุจุงุดุฑุฉ ูู Radius

2. **ุทูุจุงุช ุงูุฏูุน**
   - ุฅูุดุงุก ุทูุจุงุช ุฏูุน ุฌุฏูุฏุฉ
   - ุนุฑุถ ุทูุจุงุช ุงูุฏูุน ุงูุฎุงุตุฉ ุจู ููุท
   - ุนุฑุถ ุชูุงุตูู ุทูุจุงุชู ููุท

3. **ุงูุจุซ ุงููุจุงุดุฑ**
   - ุนุฑุถ ูุงุฆูุฉ ุงูุจุซ ุงููุจุงุดุฑ (ุนุงู)
   - ุนุฑุถ ุจุซ ูุญุฏุฏ (ุฅุฐุง ูุงู ูุฏูู `live_access = true`)

4. **ุงูุฅุดุนุงุฑุงุช**
   - ุนุฑุถ ุฌููุน ุฅุดุนุงุฑุงุชู
   - ุชุญุฏูุฏ ุฅุดุนุงุฑ ูููุฑูุก
   - ุชุญุฏูุฏ ุฌููุน ุงูุฅุดุนุงุฑุงุช ูููุฑูุกุฉ
   - ุนุฑุถ ุนุฏุฏ ุงูุฅุดุนุงุฑุงุช ุบูุฑ ุงูููุฑูุกุฉ

5. **ุงูุณูุงูุฏุงุช**
   - ุนุฑุถ ุงูุณูุงูุฏุงุช ุงููุดุทุฉ
   - ุชุชุจุน ุงูููุฑุงุช ุนูู ุงูุณูุงูุฏุงุช

#### โ ูุง ูุง ููููู ูุนูู:

- ุนุฑุถ ุทูุจุงุช ุฏูุน ุงููุณุชุฎุฏููู ุงูุขุฎุฑูู
- ูุจูู ุฃู ุฑูุถ ุทูุจุงุช ุงูุฏูุน
- ุฅุฏุงุฑุฉ ุงูุจุซ ุงููุจุงุดุฑ (ุฅูุดุงุกุ ุชุนุฏููุ ุญุฐู)
- ุฅุฏุงุฑุฉ ุงูุณูุงูุฏุงุช (ุฅูุดุงุกุ ุชุนุฏููุ ุญุฐู)
- ุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช

---

### ๐ฐ ุงููุญุงุณุจ (Accountant - Role: 1)

#### โ ูุง ููููู ูุนูู (ุจุงูุฅุถุงูุฉ ูุตูุงุญูุงุช ุงููุณุชุฎุฏู):

1. **ุฅุฏุงุฑุฉ ุทูุจุงุช ุงูุฏูุน**
   - ุนุฑุถ **ุฌููุน** ุทูุจุงุช ุงูุฏูุน ูู ุงููุธุงู
   - ุนุฑุถ ุชูุงุตูู ุฃู ุทูุจ ุฏูุน
   - ูุจูู ุทูุจุงุช ุงูุฏูุน
   - ุฑูุถ ุทูุจุงุช ุงูุฏูุน
   - ุฅุถุงูุฉ ููุงุญุธุงุช ุนูู ุงูุทูุจุงุช
   - ุชุญุฏูุฏ ูุจูุบ ููุงูู ุนููู (ุฅุฐุง ูุงู ูุฎุชูู ุนู ุงููุทููุจ)

#### โ ูุง ูุง ููููู ูุนูู:

- ุฅุฏุงุฑุฉ ุงูุจุซ ุงููุจุงุดุฑ (ุฅูุดุงุกุ ุชุนุฏููุ ุญุฐู)
- ุฅุฏุงุฑุฉ ุงูุณูุงูุฏุงุช (ุฅูุดุงุกุ ุชุนุฏููุ ุญุฐู)
- ุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช

**ููุงุญุธุฉ**: ุงููุญุงุณุจ ูุฏูู ููุณ ุตูุงุญูุงุช ุงููุณุชุฎุฏู ุงูุนุงุฏู + ุฅุฏุงุฑุฉ ุทูุจุงุช ุงูุฏูุน ููุท

---

### ๐ ุงููุฏูุฑ (Admin - Role: 2)

#### โ ูุง ููููู ูุนูู (ุฌููุน ุงูุตูุงุญูุงุช):

1. **ุฌููุน ุตูุงุญูุงุช ุงููุญุงุณุจ**

2. **ุฅุฏุงุฑุฉ ุงูุจุซ ุงููุจุงุดุฑ**
   - ุฅูุดุงุก ุจุซ ูุจุงุดุฑ ุฌุฏูุฏ
   - ุชุนุฏูู ุจุซ ููุฌูุฏ
   - ุญุฐู ุจุซ
   - ุนุฑุถ ุฌููุน ุงูุจุซ (ุญุชู ุบูุฑ ุงููุดุท)

3. **ุฅุฏุงุฑุฉ ุงูุณูุงูุฏุงุช**
   - ุฅูุดุงุก ุณูุงูุฏ ุฌุฏูุฏ
   - ุชุนุฏูู ุณูุงูุฏ ููุฌูุฏ
   - ุญุฐู ุณูุงูุฏ
   - ุนุฑุถ ุฌููุน ุงูุณูุงูุฏุงุช (ุญุชู ุบูุฑ ุงููุดุทุฉ)

4. **ุฅุฏุงุฑุฉ ุงูุฅุดุนุงุฑุงุช**
   - ุฅุฑุณุงู ุฅุดุนุงุฑ ูุฌููุน ุงููุณุชุฎุฏููู
   - ุฅุฑุณุงู ุฅุดุนุงุฑ ููุณุชุฎุฏููู ูุญุฏุฏูู
   - ุชุญุฏูุฏ ููุน ุงูุฅุดุนุงุฑ (system/manual)
   - ุชุญุฏูุฏ ุฃููููุฉ ุงูุฅุดุนุงุฑ (normal/important/urgent)

---

## ๐ฏ ุฃูุซูุฉ ุนูููุฉ

### ุงูุณููุงุฑูู 1: ูุณุชุฎุฏู ูุฑูุฏ ุฏูุน ุงุดุชุฑุงูู

**ุงููุณุชุฎุฏู**: User (Role: 0)

**ุงูุฎุทูุงุช**:
1. โ `GET /api/payment-methods` - ุนุฑุถ ุทุฑู ุงูุฏูุน
2. โ `POST /api/payment-requests` - ุฅูุดุงุก ุทูุจ ุฏูุน
3. โ `GET /api/payment-requests` - ูุชุงุจุนุฉ ุญุงูุฉ ุงูุทูุจ
4. โ `PUT /api/admin/payment-requests/1/status` - **ูุง ููููู** ูุจูู ุงูุทูุจ ุจููุณู

**ุงููุชูุฌุฉ**: ุงููุณุชุฎุฏู ููุชุธุฑ ูุฑุงุฌุนุฉ ุงููุญุงุณุจ ุฃู ุงููุฏูุฑ

---

### ุงูุณููุงุฑูู 2: ูุญุงุณุจ ูุฑุงุฌุน ุทูุจุงุช ุงูุฏูุน

**ุงููุญุงุณุจ**: Accountant (Role: 1)

**ุงูุฎุทูุงุช**:
1. โ `GET /api/admin/payment-requests?status=0` - ุนุฑุถ ุฌููุน ุงูุทูุจุงุช ุงููุนููุฉ
2. โ `GET /api/admin/payment-requests/1` - ุนุฑุถ ุชูุงุตูู ุทูุจ ูุญุฏุฏ
3. โ `PUT /api/admin/payment-requests/1/status` - ูุจูู ุฃู ุฑูุถ ุงูุทูุจ
4. โ `POST /api/admin/live-streams` - **ูุง ููููู** ุฅูุดุงุก ุจุซ ูุจุงุดุฑ

**ุงููุชูุฌุฉ**: ุงููุญุงุณุจ ููููู ุฅุฏุงุฑุฉ ุทูุจุงุช ุงูุฏูุน ููุท

---

### ุงูุณููุงุฑูู 3: ูุฏูุฑ ูุฏูุฑ ุงููุธุงู

**ุงููุฏูุฑ**: Admin (Role: 2)

**ุงูุฎุทูุงุช**:
1. โ `GET /api/admin/payment-requests` - ุนุฑุถ ุฌููุน ุงูุทูุจุงุช
2. โ `PUT /api/admin/payment-requests/1/status` - ูุจูู/ุฑูุถ ุทูุจุงุช
3. โ `POST /api/admin/live-streams` - ุฅูุดุงุก ุจุซ ูุจุงุดุฑ
4. โ `POST /api/admin/slides` - ุฅูุดุงุก ุณูุงูุฏ
5. โ `POST /api/admin/notifications` - ุฅุฑุณุงู ุฅุดุนุงุฑ

**ุงููุชูุฌุฉ**: ุงููุฏูุฑ ูุฏูู ุฌููุน ุงูุตูุงุญูุงุช

---

## ๐ ูุธุงู ุงูุชุญูู ูู ุงูุตูุงุญูุงุช

### 1. Middleware CheckRole

```php
// ูู routes/api.php
Route::middleware('role:admin,accountant')->group(function () {
    // Routes ูููุญุงุณุจ ูุงููุฏูุฑ
});

Route::middleware('role:admin')->group(function () {
    // Routes ูููุฏูุฑ ููุท
});
```

### 2. Policies

```php
// ูู Controllers
$this->authorize('viewAny', PaymentRequest::class);
$this->authorize('create', LiveStream::class);
```

### 3. Manual Checks

```php
// ูู Controllers
if ($user->isAdmin()) {
    // ููุฏ ุฎุงุต ุจุงููุฏูุฑ
}

if ($user->isAccountant() || $user->isAdmin()) {
    // ููุฏ ุฎุงุต ุจุงููุญุงุณุจ ูุงููุฏูุฑ
}
```

---

## ๐ ุฌุฏูู Routes ุญุณุจ ุงูุตูุงุญูุฉ

### Routes ุนุงูุฉ (ูุง ุชุญุชุงุฌ ูุตุงุฏูุฉ)

| Route | Method | ุงููุตู |
|-------|--------|-------|
| `/api/auth/login` | POST | ุชุณุฌูู ุงูุฏุฎูู |
| `/api/auth/register` | POST | ุงูุชุณุฌูู |
| `/api/payment-methods` | GET | ุทุฑู ุงูุฏูุน |
| `/api/slides` | GET | ุงูุณูุงูุฏุงุช |
| `/api/live-streams` | GET | ูุงุฆูุฉ ุงูุจุซ |

---

### Routes ูููุณุชุฎุฏููู ุงููุณุฌููู (auth:sanctum)

| Route | Method | User | Accountant | Admin |
|-------|--------|------|------------|-------|
| `/api/auth/me` | GET | โ | โ | โ |
| `/api/auth/logout` | POST | โ | โ | โ |
| `/api/user/profile` | GET | โ | โ | โ |
| `/api/user/profile` | PUT | โ | โ | โ |
| `/api/user/sync-subscription` | POST | โ | โ | โ |
| `/api/user/subscription-from-radius` | GET | โ | โ | โ |
| `/api/payment-requests` | GET | โ (ุฎุงุต ุจู) | โ (ุฌููุน) | โ (ุฌููุน) |
| `/api/payment-requests` | POST | โ | โ | โ |
| `/api/payment-requests/{id}` | GET | โ (ุฎุงุต ุจู) | โ (ุฌููุน) | โ (ุฌููุน) |
| `/api/live-streams/{id}` | GET | โ (ุฅุฐุง live_access) | โ (ุฅุฐุง live_access) | โ |
| `/api/slides/{id}/track-click` | POST | โ | โ | โ |
| `/api/notifications` | GET | โ (ุฎุงุต ุจู) | โ (ุฎุงุต ุจู) | โ (ุฎุงุต ุจู) |
| `/api/notifications/unread-count` | GET | โ | โ | โ |
| `/api/notifications/{id}/mark-as-read` | POST | โ | โ | โ |
| `/api/notifications/mark-all-as-read` | POST | โ | โ | โ |

---

### Routes ูููุญุงุณุจ ูุงููุฏูุฑ (role:admin,accountant)

| Route | Method | Accountant | Admin |
|-------|--------|------------|-------|
| `/api/admin/payment-requests` | GET | โ | โ |
| `/api/admin/payment-requests/{id}/status` | PUT | โ | โ |

---

### Routes ูููุฏูุฑ ููุท (role:admin)

| Route | Method | Admin |
|-------|--------|-------|
| `/api/admin/live-streams` | POST | โ |
| `/api/admin/live-streams/{id}` | PUT | โ |
| `/api/admin/live-streams/{id}` | DELETE | โ |
| `/api/admin/slides` | POST | โ |
| `/api/admin/slides/{id}` | PUT | โ |
| `/api/admin/slides/{id}` | DELETE | โ |
| `/api/admin/notifications` | POST | โ |

---

## ๐จ ุญุงูุงุช ุงูุฎุทุฃ ุงูุดุงุฆุนุฉ

### 401 Unauthorized
```
{
    "success": false,
    "message": "ุบูุฑ ูุตุฑุญ"
}
```
**ุงูุณุจุจ**: ูู ูุชู ุฅุฑุณุงู Token ุฃู Token ุบูุฑ ุตุญูุญ

---

### 403 Forbidden
```
{
    "success": false,
    "message": "ููุณ ูุฏูู ุตูุงุญูุฉ ูููุตูู ุฅูู ูุฐุง ุงูููุฑุฏ"
}
```
**ุงูุณุจุจ**: ุงููุณุชุฎุฏู ูุง ูููู ุงูุตูุงุญูุฉ ุงููุทููุจุฉ

**ุฃูุซูุฉ**:
- ูุณุชุฎุฏู ุนุงุฏู ูุญุงูู ูุจูู ุทูุจ ุฏูุน
- ูุญุงุณุจ ูุญุงูู ุฅูุดุงุก ุจุซ ูุจุงุดุฑ
- ุฃู ูุณุชุฎุฏู ูุญุงูู ุงููุตูู ูู admin routes ุจุฏูู ุตูุงุญูุฉ

---

### 404 Not Found
```
{
    "success": false,
    "message": "ุงูููุฑุฏ ุบูุฑ ููุฌูุฏ"
}
```
**ุงูุณุจุจ**: ID ุบูุฑ ุตุญูุญ ุฃู ุงูููุฑุฏ ุบูุฑ ููุฌูุฏ

---

## ๐ก ูุตุงุฆุญ ููุงุณุชุฎุฏุงู

### ูููุณุชุฎุฏููู ุงูุนุงุฏููู:
- ุงุณุชุฎุฏู `/api/payment-requests` ูุนุฑุถ ุทูุจุงุชู ููุท
- ุงุณุชุฎุฏู `/api/user/sync-subscription` ูุชุญุฏูุซ ุจูุงูุงุช ุงูุงุดุชุฑุงู
- ุงุณุชุฎุฏู `/api/user/subscription-from-radius` ููุญุตูู ุนูู ุจูุงูุงุช ูุญุธูุฉ

### ูููุญุงุณุจูู:
- ุงุณุชุฎุฏู `/api/admin/payment-requests` ูุนุฑุถ ุฌููุน ุงูุทูุจุงุช
- ุงุณุชุฎุฏู `/api/admin/payment-requests/{id}/status` ููุจูู/ุฑูุถ ุงูุทูุจุงุช
- ูุง ุชุญุงูู ุงููุตูู ูู admin routes ุงูุฃุฎุฑู

### ูููุฏูุฑูู:
- ููููู ุงููุตูู ูุฌููุน ุงูู routes
- ุงุณุชุฎุฏู `/api/admin/*` ูุฅุฏุงุฑุฉ ุงููุธุงู
- ููููู ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ูุฌููุน ุงููุณุชุฎุฏููู

---

## ๐ ุงูุฏุนู

ูููุฒูุฏ ูู ุงููุนูููุงุช:
- ุฑุงุฌุน [API Routes Documentation](./API_ROUTES_DOCUMENTATION.md) ููุชูุงุตูู ุงููุงููุฉ
- ุฑุงุฌุน [README API](./README_API.md) ูุฃูุซูุฉ ุงูุงุณุชุฎุฏุงู
- ุฑุงุฌุน ูููุงุช Controllers ูู `app/Http/Controllers/`

